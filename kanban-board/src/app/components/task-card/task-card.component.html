<div
  class="cursor-grab active:cursor-grabbing"
  draggable="true"
  (dragstart)="dragStart(task, $event)"
  (dragend)="dragEnd($event)"
>
  <ion-card class="card-custom relative shadow-md rounded-xl border border-gray-300">

    <!-- BotÃµes de aÃ§Ã£o -->
    <div class="absolute top-2 right-2 flex gap-2 z-20">

      <!-- Editar -->
      <button
        class="text-blue-600 hover:text-blue-800 transition p-2 rounded-full 
               cursor-pointer pointer-events-auto"
        (click)="onEditClick($event)"
      >
        <ion-icon name="create-outline"></ion-icon>
      </button>

      <!-- Excluir -->
      <button
        class="text-red-600 hover:text-red-800 transition p-2 rounded-full 
                 cursor-pointer pointer-events-auto"
        (click)="onDeleteClick($event)"
      >
        <ion-icon name="trash-outline"></ion-icon>
      </button>

    </div>

    <ion-card-header class="p-4">

      <ion-card-title class="text-lg font-semibold text-gray-800 pr-16">
        {{ task.title }}
      </ion-card-title>

      <span
        class="inline-block mt-1 px-3 py-1 rounded-full text-xs font-semibold"
        [ngClass]="{
          'bg-green-100 text-green-700': task.priority === 'baixa',
          'bg-yellow-100 text-yellow-700': task.priority === 'media',
          'bg-red-100 text-red-700': task.priority === 'alta'
        }"
      >
        â— {{
          task.priority === 'baixa'
            ? 'Baixa'
            : task.priority === 'media'
              ? 'MÃ©dia'
              : 'Alta'
        }}
      </span>

    </ion-card-header>

    <ion-card-content class="px-4 pb-4 text-gray-700">

      <p>{{ task.description }}</p>

      @if (task.dueDate) {
        <p class="mt-2 text-sm text-gray-500">
          ğŸ“… {{ task.dueDate | date: 'shortDate' }}
        </p>
      }

      @if (task.subtasks.length > 0) {
        <div class="mt-3 border-t pt-3">
          <p class="text-sm font-semibold text-gray-600 mb-2">
            Subtarefas
          </p>

          <ul class="space-y-2">
            @for (sub of task.subtasks; track sub.label) {

              <li class="flex items-center gap-2">
                <input
                  type="checkbox"
                  class="w-4 h-4"
                  [checked]="sub.done"
                  (change)="toggleSubtask(sub)"
                />

                <span
                  [class.line-through]="sub.done"
                  [class.text-gray-500]="sub.done"
                >
                  {{ sub.label }}
                </span>
              </li>

            }
          </ul>

        </div>
      }

    </ion-card-content>

  </ion-card>
</div>
