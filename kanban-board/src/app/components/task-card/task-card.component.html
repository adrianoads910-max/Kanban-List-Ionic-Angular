<div
  class="cursor-grab active:cursor-grabbing"
  draggable="true"
  (dragstart)="dragStart(task, $event)"
  (dragend)="dragEnd($event)"
>
  <ion-card class="shadow-md rounded-xl border border-gray-300 bg-blue-50">

    <ion-card-header class="p-4 flex justify-between items-start">

      <div>
        <ion-card-title class="text-lg font-semibold text-gray-800">
          {{ task.title }}
        </ion-card-title>

        <!-- Badge de prioridade -->
        <span
          class="inline-block mt-1 px-3 py-1 rounded-full text-xs font-semibold"
          [ngClass]="{
            'bg-green-100 text-green-700': task.priority === 'baixa',
            'bg-yellow-100 text-yellow-700': task.priority === 'media',
            'bg-red-100 text-red-700': task.priority === 'alta'
          }"
        >
          â— {{
            task.priority === 'baixa'
              ? 'Baixa'
              : task.priority === 'media'
                ? 'MÃ©dia'
                : 'Alta'
          }}
        </span>
      </div>

      <!-- BotÃ£o editar -->
      <button
        class="absolute top-2 right-2 text-blue-600 hover:text-blue-800 
             transition  p-2 rounded-full shadow-sm"
        (click)="edit.emit(task)"
      >
        <ion-icon name="create-outline"></ion-icon>
      </button>

    </ion-card-header>

    <ion-card-content class="px-4 pb-4 text-gray-700">
      <p>{{ task.description }}</p>

      @if (task.dueDate) {
        <p class="mt-2 text-sm text-gray-500">
          ğŸ“… {{ task.dueDate | date: 'shortDate' }}
        </p>
      }

      <!-- SUBTAREFAS -->
      @if (task.subtasks.length > 0) {
        <div class="mt-3 border-t pt-3">
          <p class="text-sm font-semibold text-gray-600 mb-2">
            Subtarefas
          </p>

          <ul class="space-y-2">
            @for (sub of task.subtasks; track sub.label) {
              <li class="flex items-center gap-2">

                <input
                  type="checkbox"
                  class="w-4 h-4"
                  [checked]="sub.done"
                  (change)="toggleSubtask(sub)"
                />

                <span
                  [class.line-through]="sub.done"
                  [class.text-gray-500]="sub.done"
                >
                  {{ sub.label }}
                </span>

              </li>
            }
          </ul>
        </div>
      }
    </ion-card-content>

  </ion-card>
</div>
